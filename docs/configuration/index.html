<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.98.0" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Configuration #  Packit uses a configuration file in the upstream repository. The config file is written in YAML language.
You should place the file in the root of your upstream repo. Packit accepts these names:
 .packit.yaml .packit.yml packit.yaml packit.yml  Both Packit Service and packit tool use this configuration file.
Top level keys #  specfile_path #  (string) Relative path to a spec file within the upstream repository.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Configuration" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://packit.dev/docs/configuration/" />

<title>Configuration | Packit</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.ece3f56fc3f716f87ccd4e6f3ea44ba1fa6757114261dadfbf861fde7d4e6203.css" integrity="sha256-7OP1b8P3Fvh8zU5vPqRLofpnVxFCYdrfv4Yf3n1OYgM=">
<script defer src="/en.search.min.2d116d6280cc21c4d2dcffda82bc8e64969fd4aaddf4d7a55afd4e980c891d79.js" integrity="sha256-LRFtYoDMIcTS3P/agryOZJaf1Krd9NelWv1OmAyJHXk="></script>
<link rel="alternate" type="application/rss+xml" href="https://packit.dev/docs/configuration/index.xml" title="Packit" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/packit_logo.png" alt="Logo" /><span>Packit</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>






  
<ul>
  
  <li>
    <a href="https://dashboard.packit.dev" target="_blank" rel="noopener">
        Dashboard
      </a>
  </li>
  
</ul>







  

  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2f67fdc9a362fd86f1cfd4450ed56551" class="toggle" checked />
    <label for="section-2f67fdc9a362fd86f1cfd4450ed56551" class="flex justify-between">
      <a href="https://packit.dev/docs/" class="">User Documentation</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/about/" class="">About Packit</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/guide/" class="">Packit Onboarding Guide</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/testing-farm/" class="">Testing Farm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/faq/" class="">FAQ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/configuration/" class=" active">Configuration</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/configuration/examples/" class="">Examples</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-17ea62a3fa80e270b55a640146bc89e1" class="toggle"  />
    <label for="section-17ea62a3fa80e270b55a640146bc89e1" class="flex justify-between">
      <a href="https://packit.dev/docs/cli/" class="">Packit CLI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/init/" class="">init</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/create-update/" class="">create-update</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/propose-downstream/" class="">propose-downstream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/srpm/" class="">srpm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/prepare-sources/" class="">prepare-sources</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/sync-from-downstream/" class="">sync-from-downstream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/status/" class="">status</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/push-updates/" class="">push-updates</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/validate-config/" class="">validate-config</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0b0c82992a6a45cfdc1765cc6064bbd2" class="toggle"  />
    <label for="section-0b0c82992a6a45cfdc1765cc6064bbd2" class="flex justify-between">
      <a href="https://packit.dev/docs/cli/build/" class="">build</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/build/koji/" class="">in-koji</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/build/in-image-builder/" class="">in-image-builder</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/build/mock/" class="">in-mock</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/build/local/" class="">locally</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/build/copr/" class="">in-copr</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a024048a4317a88a547d3a91b2359da1" class="toggle"  />
    <label for="section-a024048a4317a88a547d3a91b2359da1" class="flex justify-between">
      <a  class="">source-git</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/source-git/init/" class="">init</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/source-git/status/" class="">status</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/source-git/update-dist-git/" class="">update-dist-git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/cli/source-git/update-source-git/" class="">update-source-git</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/actions/" class="">Actions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/fedora-releases-guide/" class="">How to do Fedora releases with Packit</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/service-level-objectives/" class="">Service Level Objectives</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/reproduce-locally/" class="">Reproduce CI environment locally</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/docs/archive-not-matching-git/" class="">Generated code in upstream archives</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de9f4fbe058a823cefbf9e39a42e3770" class="toggle"  />
    <label for="section-de9f4fbe058a823cefbf9e39a42e3770" class="flex justify-between">
      <a href="https://packit.dev/source-git/" class="">Source-git</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/design/" class="">Source-git design</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cf8eff71d5f50a1f85c94ebde3d5a047" class="toggle"  />
    <label for="section-cf8eff71d5f50a1f85c94ebde3d5a047" class="flex justify-between">
      <a href="https://packit.dev/source-git/work-with-source-git/" class="">Working with source-git</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/create-source-git/" class="">Create a source-git repo</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/update-spec/" class="">Update a spec file</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/pull-upstream-fixes/" class="">Pull fixes from the upstream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/control-patch-generation/" class="">Controlling patch generation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/build-locally/" class="">Build current checkout locally</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/propose-to-dist-git/" class="">Propose your source-git content to dist-git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/sync-from-dist-git/" class="">Sync back changes made in dist-git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/source-git/work-with-source-git/fix-diverged-history/" class="">Diverged history</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a07783f405300745807d39eacf150420" class="toggle"  />
    <label for="section-a07783f405300745807d39eacf150420" class="flex justify-between">
      <a  class="">Blog Posts</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-dc16c8ecaf6a88aee8b0f6c668b70499" class="toggle"  />
    <label for="section-dc16c8ecaf6a88aee8b0f6c668b70499" class="flex justify-between">
      <a  class="">Weekly Status</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/march-2023/" class="">Packit March 2023</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/february-2023/" class="">Packit February 2023</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/january-2023/" class="">Packit January 2023</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/2022/" class="">2022</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/2021/" class="">2021</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/2020/" class="">2020</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/weekly/2019/" class="">2019</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/2022-features/" class="">2022 for Packit</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/pull-from-upstream/" class="">Automatic pulling of upstream releases to Fedora</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/testing-farm-triggering/" class="">Running tests with builds from another PR</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/fas-verification-automation/" class="">Automation of FAS verification in Packit Service</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/downstream-automation/" class="">Downstream automation is here</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/copr-srpms/" class="">Building SRPMs in Copr</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/2021-features/" class="">2021 for Packit</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/2021-in-numbers/" class="">2021 in Numbers</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/posts/fedora-eln/" class="">Working on the next major RHEL release, in your upstream repo</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-03ded75136420a051aef84f84237f006" class="toggle"  />
    <label for="section-03ded75136420a051aef84f84237f006" class="flex justify-between">
      <a href="https://packit.dev/development-docs/" class="">Development Documentation</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/development-docs/creating-stream-9-repos/" class="">Creating CentOS Stream 9 source-git repositories</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://packit.dev/development-docs/patch-metadata/" class="">Source-git patch metadata</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="https://status.packit.dev" target="_blank" rel="noopener">
        Status page
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Configuration</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#top-level-keys">Top level keys</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#packit-as-a-service">Packit-as-a-Service</a>
      <ul>
        <li><a href="#packit-service-jobs">Packit service jobs</a></li>
      </ul>
    </li>
    <li><a href="#user-configuration-file">User configuration file</a>
      <ul>
        <li><a href="#values">Values</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="configuration">
  Configuration
  <a class="anchor" href="#configuration">#</a>
</h1>
<p>Packit uses a configuration file in the upstream repository. The config file is written in YAML language.</p>
<p>You should place the file in the root of your upstream repo. Packit accepts these names:</p>
<ul>
<li><code>.packit.yaml</code></li>
<li><code>.packit.yml</code></li>
<li><code>packit.yaml</code></li>
<li><code>packit.yml</code></li>
</ul>
<p>Both Packit Service and packit tool use this configuration file.</p>
<h2 id="top-level-keys">
  Top level keys
  <a class="anchor" href="#top-level-keys">#</a>
</h2>
<h4 id="specfile_path">
  specfile_path
  <a class="anchor" href="#specfile_path">#</a>
</h4>
<p>(<em>string</em>) Relative path to a spec file within the upstream repository.
If not specified, defaults to:</p>
<ol>
<li><code>downstream_package_name.spec</code> if <a href="#downstream_package_name"><code>downstream_package_name</code></a>
is set.</li>
<li>(<em>deprecated</em>) Else recursively search the tree and use the first spec file found.</li>
</ol>
<p>If there are only test jobs with <code>skip_build</code> option defined (more about it <a href="http://packit.dev/testing-farm/">here</a>),
spec file doesn&rsquo;t need to be present and its path doesn&rsquo;t need to be defined in the config.</p>
<p>The functionality to recursively search for a specfile is deprecated and it&rsquo;s
going to be <a href="https://github.com/packit/packit/issues/1799">removed</a> in a
future version (&gt;0.64.0) of Packit. We recommend projects to explicitly set
<code>specfile_path</code> or rely on the <code>&lt;downstream_package_name&gt;.spec</code> default, by
setting <code>downstream_package_name</code>.</p>
<h4 id="upstream_project_name-deprecated">
  <del>upstream_project_name</del> (deprecated)
  <a class="anchor" href="#upstream_project_name-deprecated">#</a>
</h4>
<p>(<em>string</em>) Deprecated since packit-0.7.0, use <a href="#upstream_package_name"><code>upstream_package_name</code></a> instead.</p>
<h4 id="upstream_package_name">
  upstream_package_name
  <a class="anchor" href="#upstream_package_name">#</a>
</h4>
<p>(<em>string</em>) Name of the upstream repository (e.g. in PyPI), defaults to the
name of the GitHub repository; it&rsquo;s used when working with the upstream project,
as a release archive name and as a directory name in that archive.</p>
<h4 id="upstream_project_url">
  upstream_project_url
  <a class="anchor" href="#upstream_project_url">#</a>
</h4>
<p>(<em>string</em>) URL of the upstream git project (e.g.
<code>https://github.com/packit/packit</code>).</p>
<h4 id="create_pr-only-in-cli">
  create_pr (only in CLI)
  <a class="anchor" href="#create_pr-only-in-cli">#</a>
</h4>
<p>(<em>bool</em>) When doing a new update in Fedora dist-git, should packit create a
new pull request (defaults to <code>true</code>) or push directly to dist-git (if set to
<code>false</code>). This option can be used only locally in the CLI, but can be overriden
via <code>--pr/--no-pr</code> option. Deployed Packit (on GitHub or GitLab) ignores this
setting, because Packit Team <strong>does not</strong> endorse automated release from created
release to the Bodhi update <strong>without any quality assurance</strong>.</p>
<h4 id="merge_pr_in_ci">
  merge_pr_in_ci
  <a class="anchor" href="#merge_pr_in_ci">#</a>
</h4>
<p>(<em>bool</em>) When Packit clones your repository while creating RPMs from your pull
requests, it by default merges the pull request checkout into the main
repository branch to be sure the changes are up to date. You can disable this
behaviour by setting this field to <code>false</code> which will make Packit to work with
your pull request git ref as it is.</p>
<h4 id="sync_changelog">
  sync_changelog
  <a class="anchor" href="#sync_changelog">#</a>
</h4>
<p>(<em>bool</em>) When doing a new update in Fedora dist-git, the specfile changelog
is synchronized when set to <code>true</code>. By default (<code>false</code>), everything but the changelog
part is synchronized. Use this only when your changelogs are in sync since this overwrites the changelog in the downstream.</p>
<h4 id="synced_files-deprecated">
  <del>synced_files</del> (deprecated)
  <a class="anchor" href="#synced_files-deprecated">#</a>
</h4>
<p>(<em>list of strings or dicts</em>) A list of relative paths to files in the upstream
repo which are meant to be copied to dist-git during an update (spec file path
and config file path are set every time by default).</p>
<p>It is now deprecated in favor of <a href="#files_to_sync"><code>files_to_sync</code></a>.</p>
<h4 id="update_release">
  update_release
  <a class="anchor" href="#update_release">#</a>
</h4>
<p>(<em>bool</em>) Packit by default modifies Release in the spec file when
creating a SRPM. If you don&rsquo;t want this, you can prevent it with</p>
<pre><code>update_release: false
</code></pre>
<p>This option only applies to SRPM creation and doesn&rsquo;t affect <a href="#propose_downstream"><code>propose_downstream</code></a>
and <a href="#pull_from_upstream"><code>pull_from_upstream</code></a> jobs.</p>
<h4 id="release_suffix">
  release_suffix
  <a class="anchor" href="#release_suffix">#</a>
</h4>
<p>(<em>templated string</em>) String that can be used to override the default release suffix
generated by Packit. The suffix will be expanded, and you can use following variables:</p>
<ul>
<li><code>PACKIT_PROJECT_VERSION</code> - version from <code>git describe</code></li>
<li><code>PACKIT_RPMSPEC_RELEASE</code> - release from specfile</li>
<li><code>PACKIT_PROJECT_COMMIT</code> - commit SHA from which the SRPM is built</li>
<li><code>PACKIT_PROJECT_BRANCH</code> - branch from which the SRPM is built</li>
</ul>
<p>Example usage:</p>
<pre><code>release_suffix: &quot;dev.{PACKIT_PROJECT_BRANCH}&quot;
</code></pre>
<p>When unset, default release suffix that is generated by Packit is following:</p>
<pre><code>{original_release_number}.{current_time}.{sanitized_current_branch}{git_desc_suffix}
</code></pre>
<p>It is also possible to define <code>release_suffix</code> at the top-level of your packit
config. In that situation all jobs and SRPM, Copr, Koji and RPM build from CLI
will inherit the <code>release_suffix</code> that you have set. We <strong>advise</strong> caution when
doing such thing, because inheriting the release suffix value by Copr or Koji
build may easily cause confusion, break the ordering of the NVRs of the RPMs and
also may cause usage of RPMs <strong>that are not meant</strong> for production use. In such
scenarios, please try to make sure RPMs built by Packit are easily
distinguishable from the RPMs meant for production use. To prevent the
inheritance, you can define:</p>
<pre><code>release_suffix: null
</code></pre>
<p>If you don&rsquo;t want the release to be modified at all, see <a href="#update_release">update_release</a>.</p>
<p>This option only applies to SRPM creation and doesn&rsquo;t affect <a href="#propose_downstream"><code>propose_downstream</code></a>
and <a href="#pull_from_upstream"><code>pull_from_upstream</code></a> jobs.</p>
<h4 id="files_to_sync">
  files_to_sync
  <a class="anchor" href="#files_to_sync">#</a>
</h4>
<p>(<em>list of strings or dicts</em>) A list of relative paths to files in the upstream
repo which are meant to be copied to dist-git during an update.</p>
<p>Spec file path and config file path are always included by <code>packit init</code>
but can be manually removed from the list.</p>
<p>Under the hood this will use <code>rsync --archive</code> to synchronise the paths
between the upstream and the dist-git repo.</p>
<p>The fields for a dictionary item in the list are the following:</p>
<ul>
<li><em>src</em>: A single path or a list of paths in the upstream repo that should be synced to dist-git.</li>
<li><em>dest</em>: Path in the dist-git repo, where paths in <code>src</code> should be synced to.</li>
<li><em>mkpath</em>: Flag to indicate if missing path components in <code>dest</code> should be created or not (default: false).</li>
<li><em>delete</em>: Flag to indicate if extra content from <code>dest</code> should be deleted (default: false).</li>
<li><em>filters</em>: List of <a href="https://www.man7.org/linux/man-pages/man1/rsync.1.html#FILTER_RULES">rsync filter rules</a> to be used during syncing.</li>
</ul>
<h5 id="examples">
  Examples:
  <a class="anchor" href="#examples">#</a>
</h5>
<p>Copy a file from root of the upstream repo to dist-git:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">packit.spec</span>
</span></span></code></pre></div><p>If you copy <code>packit.yaml</code> downstream, you can then take advantage of
<code>sync-from-downstream</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">.packit.yaml</span>
</span></span></code></pre></div><p>Rename or change the path of the synced file in dist-git:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">src</span>: <span style="color:#ae81ff">packit.spec</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">redhat/packit.spec</span>
</span></span></code></pre></div><p>Paths also support globs. Copy everything from <code>fedora-packaging</code> folder and
put it to the root of the dist-git repo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">src</span>: <span style="color:#ae81ff">fedora-packaging/*</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">.</span>
</span></span></code></pre></div><p>Sync the entire content of the <code>fedora-packaging</code> directory, and delete extra
content found in the root of the dist-git repo; protect <code>.git*</code> files and the
<code>sources</code> file from deletion:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">src</span>: <span style="color:#ae81ff">fedora-packaging/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">delete</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">filters</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#34;protect .git*&#34;</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#34;protect sources&#34;</span>
</span></span></code></pre></div><p>Specify multiple source files to copy:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">src</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">package.spec</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">some-file</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">.</span>
</span></span></code></pre></div><p>Set <code>mkpath</code> to <code>true</code> to create missing path components in dist-git.
In the example below, <code>subdir</code> is created if missing.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">files_to_sync</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">src</span>: <span style="color:#ae81ff">some.file</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">subdir/some.file</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mkpath</span>: <span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h4 id="create_sync_note">
  create_sync_note
  <a class="anchor" href="#create_sync_note">#</a>
</h4>
<p>(<em>bool</em>) Create or update a <em>README.packit</em> file in dist-git when doing a new update,
telling that the repository is maintained by Packit and marking the version of <code>packit</code> creating the update.
By default, this option is set to <code>true</code>. When set to <code>false</code>, <em>README.packit</em> is not created or updated.
(A previously created <em>README.packit</em> needs to be removed manually).</p>
<h4 id="upstream_ref">
  upstream_ref
  <a class="anchor" href="#upstream_ref">#</a>
</h4>
<p>(<em>string</em>) Git reference to last upstream git commit (for source-git repos).
Can be set to commit hash, tag or a branch name. You can also use globbing pattern
to find a tag. In case you want to use globbing pattern for a branch, prefix the
pattern with <code>branches/</code>, e.g. for a branch matching <code>*-release</code> set to <code>branches/*-release</code>.</p>
<h4 id="downstream_package_name">
  downstream_package_name
  <a class="anchor" href="#downstream_package_name">#</a>
</h4>
<p>(<em>string</em>) Name of the RPM package in Fedora, defaults to the name of the
GitHub repository.</p>
<h4 id="dist_git_namespace">
  dist_git_namespace
  <a class="anchor" href="#dist_git_namespace">#</a>
</h4>
<p>(<em>string</em>) Namespace in dist-git URL (defaults to <code>rpms</code>).</p>
<h4 id="dist_git_base_url">
  dist_git_base_url
  <a class="anchor" href="#dist_git_base_url">#</a>
</h4>
<p>(<em>string</em>) URL of dist-git server, defaults to <a href="https://src.fedoraproject.org/">https://src.fedoraproject.org/</a>
(has to end with a slash).</p>
<h4 id="create_tarball_command-deprecated">
  <del>create_tarball_command</del> (deprecated)
  <a class="anchor" href="#create_tarball_command-deprecated">#</a>
</h4>
<p>Please use <a href="/docs/actions/"><code>create-archive</code> action</a></p>
<h4 id="current_version_command-deprecated">
  <del>current_version_command</del> (deprecated)
  <a class="anchor" href="#current_version_command-deprecated">#</a>
</h4>
<p>Please use <a href="/docs/actions/"><code>get-current-version</code> action</a></p>
<h4 id="actions">
  actions
  <a class="anchor" href="#actions">#</a>
</h4>
<p>(<em>string</em>) Custom actions/hooks overwriting the default behavior of packit
(more in <a href="/docs/actions/">Actions</a>).</p>
<h4 id="jobs">
  jobs
  <a class="anchor" href="#jobs">#</a>
</h4>
<p>(<em>list of dicts</em>) A list of job definitions for packit service: see
<a href="#supported-jobs">below</a> for details.</p>
<h4 id="allowed_gpg_keys">
  allowed_gpg_keys
  <a class="anchor" href="#allowed_gpg_keys">#</a>
</h4>
<p>(<em>list of string</em>) A list of gpg-key fingerprints; if specified, one of the
configured keys have to sign the last commit when updating in downstream; add
GitHub key (<code>5DE3E0509C47EA3CF04A42D34AEE18F83AFDEB23</code>) if you want to use
this on code merged via GitHub web interface.</p>
<h4 id="spec_source_id">
  spec_source_id
  <a class="anchor" href="#spec_source_id">#</a>
</h4>
<p>(<em>int or string</em>) Numeric ID of Source inside spec file which packit should
change when setting path to the newly generated tarball, can be also full name
of the macro. Defaults to <code>Source0</code> or <code>Source</code>, whichever is found first in
the spec file.</p>
<h4 id="upstream_tag_template">
  upstream_tag_template
  <a class="anchor" href="#upstream_tag_template">#</a>
</h4>
<p>(<em>string</em>) Packit by default expects git tags to match versions (e.g. when
doing the <a href="/docs/cli/propose-downstream/"><code>propose-downstream</code> command</a>) -
if you are using a different tagging scheme, let&rsquo;s say <code>v1.2.3</code>
you can then set this parameter to <code>v{version}</code> and
packit will fill in the version argument.</p>
<h4 id="archive_root_dir_template">
  archive_root_dir_template
  <a class="anchor" href="#archive_root_dir_template">#</a>
</h4>
<p>(string) In the <a href="/docs/actions/"><code>fix-spec-file</code> action</a> Packit changes first <code>%setup</code> (or <code>%autosetup</code>) macro
in <code>%prep</code> and adds <code>-n</code> so the generated tarball can be unpacked. For this
purpose, it requires the name of the directory in the source archive. For tar archives
with one directory, Packit gets it automatically. If Packit is not able to extract it
from the archive with the tar python module, it is possible to specify it explicitly
with this option.</p>
<p>Default value is <code>{upstream_pkg_name}-{version}</code>.</p>
<p>You can use following tags in string:</p>
<ul>
<li><code>{upstream_pkg_name}</code> - name of the upstream package</li>
<li><code>{version}</code> - package version</li>
</ul>
<h4 id="patch_generation_ignore_paths">
  patch_generation_ignore_paths
  <a class="anchor" href="#patch_generation_ignore_paths">#</a>
</h4>
<p>(<em>list of strings</em>) In a source-git repo, when packit is generating patches,
it excludes changes to the spec file and packit.yaml by default: with this
option you can precisely specify paths to exclude.</p>
<h4 id="patch_generation_patch_id_digits">
  patch_generation_patch_id_digits
  <a class="anchor" href="#patch_generation_patch_id_digits">#</a>
</h4>
<p>(<em>integer</em>) The number of digits (minimum width) used for patch IDs when
adding <code>PatchN</code> tags to a spec-file while updating dist-git from a source-git
repository.  Defaults to 4, that is, patches will look like <code>PatchNNNN: &lt;patch_name&gt;</code>, and leading zeros are added, if needed. A value of 0 means &ldquo;no
minimum width&rdquo;.</p>
<h4 id="notifications">
  notifications
  <a class="anchor" href="#notifications">#</a>
</h4>
<p>There is only one notification configuration you can set up right now: enable
the &ldquo;Congratulations!&rdquo; comment which will packit send after a successful build of a
pull request is done.</p>
<p>The default behaviour is not to send the comment with instructions how to install a
package with the change implemented in the pull request:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">notifications</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">pull_request</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">successful_build</span>: <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><p>You can enable the commenting by setting <code>successful_build</code> to <code>true</code>.</p>
<h4 id="issue_repository">
  issue_repository
  <a class="anchor" href="#issue_repository">#</a>
</h4>
<p>Use this key to be notified about errors of the downstream jobs (Koji build, Bodhi update, pull from upstream).
The value can be a URL of any GitHub/GitLab/Pagure project including dist-git
where issues are enabled and Packit has an identity on that git forger instance.
Alternatively, you can set up a dedicated project for receiving such notifications.
(Let us know if you need another instance to be supported.)
It does not need to be an upstream repository,
you can also enable an issue tracker for the dist-git repository
and use this as a place for those notifications.
Or, you can set up a dedicated project for receiving such notifications.</p>
<p>By default, no issue will be created so Packit doesn&rsquo;t unintentionally spam any repository.
(E.g. Since those jobs are defined in downstream, upstream project does not need to be aware of Packit.)</p>
<p>By enabling this setting, Packit will either create a new issue or add a comment to an already existing issue.
In that case, the issue will be reused and a new comment will be added.</p>
<p>When a downstream job (e.g. Koji build or Bodhi update) fails,
you can re-trigger the failed job by<br>
<code>/packit koji-build</code> or <code>/packit create-update</code> comment in the opened issue by Packit.
The Packit app has to be installed in the issue repository and the
user, who commented, needs to have write permissions
into the repository in order for the retriggering to work.</p>
<h4 id="copy_upstream_release_description">
  copy_upstream_release_description
  <a class="anchor" href="#copy_upstream_release_description">#</a>
</h4>
<p>(<em>bool</em>) When doing a new update in Fedora dist-git, the <a href="https://docs.github.com/en/repositories/releasing-projects-on-github/about-releases">GitHub upstream release description</a>
is copied to the specfile changelog when set to <code>true</code>. By default (<code>false</code>),
commit message titles (first line of a commit message) are copied.
But be aware that the release description is copied as is, without any processing
and the result needs to fulfill the spec-file syntax.
Be specially careful when using characters like <code>%</code> that can be interpreted as macros.
Also, use <code>-</code> for bullet points instead of <code>*</code> so the line is not interpreted as a new changelog entry.</p>
<p>e.g.</p>
<ul>
<li><code>copy_upstream_release_description = True</code>:</li>
</ul>
<pre tabindex="0"><code>%changelog
* Thu Oct 15 2020 Packit Service &lt;user-cont-team+packit-service@redhat.com&gt; - 0.18.0-1
Packit got new archive_root_dir_template config option to get custom archive root dir.
You can find more info in the documentation.
</code></pre><ul>
<li><code>copy_upstream_release_description = False</code> (default):</li>
</ul>
<pre tabindex="0"><code>%changelog
* Thu Oct 15 2020 Packit Service &lt;user-cont-team+packit-service@redhat.com&gt; - 0.18.0-1
- Use inner archive directory in %setup macro
- Use archive_root_dir_template
</code></pre><h4 id="sources">
  sources
  <a class="anchor" href="#sources">#</a>
</h4>
<p>(<em>list of dicts</em>) A list of sources to override the URLs of <code>SourceX</code> entries in the spec-file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">sources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">rsync-3.1.3.tar.gz</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">url</span>: <span style="color:#ae81ff">https://git.centos.org/sources/rsync/c8s/82e7829c0b3cefbd33c233005341e2073c425629</span>
</span></span></code></pre></div><p><code>path</code> is the path relative to the directory with sources where the source will be placed. If a <code>SourceX</code> entry with
corresponding basename exists in the spec-file, the source will be downloaded from the <code>url</code> found in the configuration
instead of the location defined in the spec-file.</p>
<h4 id="srpm_build_deps">
  srpm_build_deps
  <a class="anchor" href="#srpm_build_deps">#</a>
</h4>
<p>(<em>list of strings</em>) A list of RPM dependencies that are needed for your actions to be run when building a SRPM.
The dependencies are installed into the Copr build environment each time the build is triggered.</p>
<h4 id="packit_instances">
  packit_instances
  <a class="anchor" href="#packit_instances">#</a>
</h4>
<p>(<em>list of strings</em>) If you want to help us with catching issues or need some feature sooner than other users,
you can use our staging instance that has the freshest code we have.
For that, you can specify the instance(s) that will react to your jobs by using this configuration option.
It uses <code>[&quot;prod&quot;]</code> as the default, but you can set both (<code>[&quot;prod&quot;, &quot;stg&quot;]</code>) or just stage (<code>[&quot;stg&quot;]</code>).
You can also have a different setup for each job &ndash; see <a href="#overriding-global-parameters">how the overriding works</a>
in the config file.</p>
<p>Just be aware that:</p>
<ul>
<li>You still need to install <a href="https://github.com/apps/packit-as-a-service-stg">the staging GitHub application</a>.</li>
<li>Staging application has fewer resources and can be a bit slower in responses.</li>
<li>If you use both instances, you will have twice the number of commit statuses.</li>
<li>Picking just one instance might be better for downstream jobs since
both instances will work with the production instances of Fedora systems.</li>
</ul>
<p>Please, let us know when something looks weird or does not work with the staging app.
By doing that, you are helping us to be sure that we don&rsquo;t break your use-case.</p>
<h2 id="packit-as-a-service">
  Packit-as-a-Service
  <a class="anchor" href="#packit-as-a-service">#</a>
</h2>
<p>Packit service doesn&rsquo;t have any web interface to configure it,
so the only way to change its behaviour is via the config file you just read about.</p>
<p>When you open a pull request against your upstream repository, packit service
picks up configuration file from your pull request, not from the branch against
the PR is opened. This way, you can polish your .packit.yaml and see the
results right away. (for more info, please see <a href="https://github.com/packit/packit-service/issues/48">packit-service#48</a>)</p>
<h3 id="packit-service-jobs">
  Packit service jobs
  <a class="anchor" href="#packit-service-jobs">#</a>
</h3>
<p>Once the service starts handling events of your repository, it needs to have a
clear definition of what it should do.</p>
<p>The tasks the packit service should do are defined in section <code>jobs</code>. The section is a list of dicts:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- {<span style="color:#f92672">key</span>: <span style="color:#ae81ff">value}</span>
</span></span><span style="display:flex;"><span>- {}
</span></span></code></pre></div><p>If there is no <code>jobs</code> section in the configuration file, jobs default to:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>: [<span style="color:#ae81ff">fedora-stable]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">tests</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>: [<span style="color:#ae81ff">fedora-stable]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">propose_downstream</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">release</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dist_git_branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">fedora-all</span>
</span></span></code></pre></div><p>If you do not want to use the jobs then the <code>jobs</code> section in the configuration file should be empty:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>: []
</span></span></code></pre></div><p>Packit configuration supports <a href="https://yaml.org/type/merge.html">YAML Merge Key syntax</a>, which can be used to reduce duplication of configuration. Please see the example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># before</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-8-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-9-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">fedora-all</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">commit</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">branch</span>: <span style="color:#ae81ff">main</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-8-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-9-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">fedora-all</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># after</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#75715e">&amp;copr</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-8-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">centos-stream-9-x86_64</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">fedora-all</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">&lt;&lt;</span>: <span style="color:#75715e">*copr</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">commit</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">branch</span>: <span style="color:#ae81ff">main</span>
</span></span></code></pre></div><p>Every job has two mandatory keys:</p>
<ol>
<li><code>job</code> - name of the job (you can imagine this as a CLI command)</li>
<li><code>trigger</code> - what is the trigger for the job?</li>
</ol>
<p>Every job only supports a specific set of triggers.</p>
<h5 id="overriding-global-parameters">
  Overriding global parameters
  <a class="anchor" href="#overriding-global-parameters">#</a>
</h5>
<p>You are able to override your global parameters (such as <a href="#specfile_path"><code>specfile_path</code></a>,
<a href="#downstream_package_name"><code>downstream_package_name</code></a>,
<a href="#actions"><code>actions</code></a>&hellip;) for every job. This is very useful
when you want to set up a build or a test matrix using different parameters or
configuration. It&rsquo;s also useful when your release workflow differs between
Fedora and EPEL.</p>
<p>In order to do such a thing, just set a value you want to override in the
respective job.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">specfile_path</span>: <span style="color:#ae81ff">package.spec</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">some-job</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">ran-out-of-beer</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>: [<span style="color:#ae81ff">fedora-stable]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">specfile_path</span>: <span style="color:#ae81ff">somewhere/else/package.spec</span>
</span></span></code></pre></div><p>In this example, the job <code>some-job</code> would override <a href="#specfile_path"><code>specfile_path</code></a> to
<code>somewhere/else/package.spec</code> instead of using <code>./package.spec</code>.</p>
<h4 id="aliases">
  Aliases
  <a class="anchor" href="#aliases">#</a>
</h4>
<p>To not need to change the config file when the new system version is released,
Packit provides multiple aliases to reference a subset of the active
Fedora Linux releases:</p>
<ul>
<li><code>fedora-all</code> - all active releases, which includes released and branched
versions and Rawhide (e.g. <code>fedora-34</code>, <code>fedora-35</code>, <code>fedora-36</code>,
<code>fedora-rawhide</code>).</li>
<li><code>fedora-stable</code> — the current (two or three) released and supported
versions (e.g. <code>fedora-34</code>, <code>fedora-35</code>).</li>
<li><code>fedora-development</code> — development versions of Fedora; the branched
version is used only when available (e.g. <code>fedora-36</code>, <code>fedora-rawhide</code>)</li>
<li><code>fedora-latest</code> — the last versioned Fedora (not a Rawhide), regardless if
it&rsquo;s released or still under development.</li>
<li><code>fedora-latest-stable</code> — the latest released Fedora version (e.g.
<code>fedora-35</code>).</li>
<li><code>fedora-branched</code> — all branched releases, that is: everything, except
Rawhide (e.g. <code>fedora-34</code>, <code>fedora-35</code>, <code>fedora-36</code>).</li>
</ul>
<p>Additionally, <code>epel-all</code> can be used as an alias for the current active
<a href="https://docs.fedoraproject.org/en-US/epel/">EPEL</a> versions (e.g. <code>epel-7</code>,
<code>epel-8</code>, <code>epel-9</code>)</p>
<p>The aliases above can be used both to specify targets when <a href="#copr_build">building in
Copr</a> or <a href="/testing-farm/">running tests</a>, and to reference
dist-git branches of different system versions
(e.g. for <a href="#propose_downstream"><code>propose_downstream</code> job</a>
or downstream jobs like <a href="#koji_build"><code>koji_build</code></a> or <a href="#bodhi_update"><code>bodhi_update</code></a>).</p>
<p>The information about releases is retrieved from Bodhi and because of the
cache and required availability on Copr, it might take a while to get the
newest state.</p>
<h4 id="supported-jobs">
  Supported jobs
  <a class="anchor" href="#supported-jobs">#</a>
</h4>
<h5 id="copr_build">
  copr_build
  <a class="anchor" href="#copr_build">#</a>
</h5>
<p>Create a SRPM and submit an RPM build to <a href="https://copr.fedorainfracloud.org/">Fedora COPR</a> build system.</p>
<p>Supported triggers:</p>
<ul>
<li><strong>pull_request</strong> &ndash; check out content of the pull request</li>
<li><strong>commit</strong> &ndash; reacts to new commits to the specified branch</li>
<li><strong>release</strong> &ndash; check out content of the tag associated with the release</li>
</ul>
<p>Required parameters:</p>
<ul>
<li><strong>targets</strong> - (a list of) mock chroot(s) where the build is going to be
executed (example <code>fedora-rawhide-x86_64</code>, defaults to <code>fedora-stable</code>): for
more info <a href="#available-copr-build-targets">see below</a>. Does not need to be
defined if using a custom Copr project (we fetch targets from the Copr settings).</li>
<li><strong>branch</strong> - the name of the branch we want to build for when using <strong>commit</strong> trigger</li>
</ul>
<p>Optional parameters:</p>
<ul>
<li><strong>timeout</strong> - (seconds) give up watching a build after timeout, defaults to 7200s, i.e. 2 hours</li>
<li><strong>owner</strong> - a namespace in Copr where the build should happen (defaults to packit).
Prefix with <code>@</code> in case of a group.</li>
<li><strong>project</strong> - a name of the Copr project (defaults to <code>&quot;{github_namespace}-{repository_name}-{pr_id}&quot;</code>)</li>
<li><strong>additional_repos</strong> - a list of additional buildroot repositories</li>
<li><strong>list_on_homepage</strong> &ndash; The project will be shown on Copr frontend homepage if set to <code>True</code>.
Defaults to <code>False</code>.
The value is represented as <code>unlisted_on_hp</code> in Copr project settings.</li>
<li><strong>preserve_project</strong> &ndash; The project will not be removed after 60 days if set to <code>True</code>.
Defaults to <code>False</code>.
The value is represented as <code>delete_after_days</code> in Copr project settings
(<code>True</code> is <code>-1</code> and <code>False</code> is <code>60</code>).</li>
<li><strong>enable_net</strong> &ndash; Specifies whether created Copr build should have access to network during its build.
Defaults to <code>False</code> (Copr default, switched to <code>False</code> in June 2022).</li>
<li><strong>identifier</strong> &ndash; Suffix added to the name of a GitHub check run. This is
useful when you have multiple <code>copr_build</code> jobs with different configuration.
For example if you <a href="https://github.com/rpm-software-management/mock/pull/902/checks?check_run_id=6530714905">set this to &ldquo;mock&rdquo;</a>, then a check run for Rawhide would be
named &ldquo;rpm-build:fedora-rawhide-x86_64:mock&rdquo;.</li>
<li><strong>module_hotfixes</strong> &ndash; The project will have <code>module_hotfixes=1</code> in the Copr generated repo files.
This is useful when you build packages that need to be installed in a modular context.
Defaults to <code>False</code>.</li>
</ul>
<h5 id="using-a-custom-copr-project">
  Using a custom Copr project
  <a class="anchor" href="#using-a-custom-copr-project">#</a>
</h5>
<p>When using a custom Copr project (by specifying <code>project</code> and <code>owner</code>), the GitHub repo has to be listed in the
<strong>Packit allowed forge projects</strong> field in the <strong>Copr project settings</strong> so that the Copr builds can be actually run.
As an example the string <em>github.com/osbuild/osbuild</em> has to be inserted
into <a href="https://copr.fedorainfracloud.org/coprs/g/osbuild/osbuild/edit/#packit_forge_projects_allowed">https://copr.fedorainfracloud.org/coprs/g/osbuild/osbuild/edit/#packit_forge_projects_allowed</a>.</p>
<p>When using a custom <code>owner</code>, Packit Service asks for <code>builder</code> permission the
first time it tries to build in the project. In case the configuration of the
Copr project (e.g. adding new <code>targets</code>) need to be updated, Packit Service asks
for <code>admin</code> permission. You need to approve these requests in the Copr project
settings.</p>
<p>If you do not want to give us <code>admin</code> permission, you can update the project
settings manually in Copr based on the guidance Packit Service gives.</p>
<p>You can also directly edit the permissions yourself without waiting for the Packit request
by running:</p>
<pre><code>$ copr-cli edit-permissions --builder packit [--admin packit] &lt;project&gt;
</code></pre>
<p>Boolean values (<code>list_on_homepage</code> and <code>preserve_project</code>) are not updated when
you use custom <code>owner</code>.</p>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">fedora-stable</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">centos-stream-8-x86_64</span>
</span></span></code></pre></div><p>With this configuration, you&rsquo;ll get builds in all stable fedora releases
(excluding rawhide) and the CentOS stream.</p>
<h5 id="target-specific-configuration">
  Target-specific configuration
  <a class="anchor" href="#target-specific-configuration">#</a>
</h5>
<p>You can define a specific build configuration for different targets (chroots in
context of Copr). For example, there are packages that are architecture
specific and not available for all architectures. Or you may want <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/installing_managing_and_removing_user-space_components/introduction-to-modules_using-appstream">modules</a>
enabled for builds in CentOS Stream 8.</p>
<p><a href="https://python-copr.readthedocs.io/en/latest/client_v3/proxies.html#project-chroot">Copr allows specifying additional packages, modules and repos</a> for individual targets.</p>
<p>Setting this in packit.yaml requires targets to be a mapping. If you require
this functionality, this is the preferred solution over specifying multiple
jobs. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ae81ff">jobs</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">copr_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">targets</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">centos-stream-8</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">additional_repos</span>:
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">http://koji.katello.org/releases/yum/foreman-nightly/el8/x86_64/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">additional_modules</span>: <span style="color:#e6db74">&#34;foreman:el8,ruby:2.7,nodejs:12,postgresql:12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fedora-rawhide</span>: {}
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">fedora-37</span>: {}
</span></span></code></pre></div><p>In this case, both Fedora targets don&rsquo;t have anything specific and would use
packages and modules from the base distro, while CentOS Stream 8 will use a
custom yum repo and 4 specific modules.</p>
<p>You can define these three options:</p>
<ul>
<li><code>additional_packages</code> (list) – install additional packages before the build</li>
<li><code>additional_repos</code> (list) – enable these yum repositories before installing any packages</li>
<li><code>additional_modules</code> (str) – enable these modules before installing packages,
specified as comma-separated string: <code>MODULE:STREAM,MODULE2:STREAM2,...</code></li>
</ul>
<h5 id="available-copr-build-targets">
  Available COPR build targets
  <a class="anchor" href="#available-copr-build-targets">#</a>
</h5>
<p>There are multiple places where you can get the latest list of available build targets:</p>
<ul>
<li>
<p>Open your COPR project, then click &ldquo;Settings&rdquo; &gt; &ldquo;Build options&rdquo; &gt; &ldquo;Chroots&rdquo; -
these are the same values packit accepts.</p>
</li>
<li>
<p>Install package <code>copr-cli</code> and run:</p>
</li>
</ul>
<pre tabindex="0"><code>$ copr-cli list-chroots
centos-stream-8-aarch64
centos-stream-8-x86_64
custom-1-i386
custom-1-x86_64
epel-6-i386
epel-6-x86_64
epel-7-aarch64
epel-7-x86_64
epel-8-aarch64
epel-8-x86_64
fedora-32-aarch64
fedora-32-armhfp
...
</code></pre><ul>
<li>
<p>You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</p>
<p>By default, the <code>x86_64</code> architecture will be used, but you you can
override the default e.g. <code>fedora-stable-aarch64</code>.</p>
</li>
<li>
<p>If you are using custom Copr repository for your Copr builds, you don&rsquo;t have
to define the targets at all and they will be deduced from your custom Copr
project.</p>
</li>
</ul>
<h5 id="tests">
  tests
  <a class="anchor" href="#tests">#</a>
</h5>
<p>See more about tests <a href="/testing-farm/">here</a>.</p>
<h5 id="upstream_koji_build">
  upstream_koji_build
  <a class="anchor" href="#upstream_koji_build">#</a>
</h5>
<p>Create a SRPM from upstream and submit a scratch RPM build
to <a href="https://koji.fedoraproject.org/koji/">Fedora Koji</a> build system.</p>
<p>At the moment it is not possible to run non-scratch Koji builds from upstream.
For more info, please see <a href="https://pagure.io/releng/issue/9801">the following issue</a>.</p>
<p>If you want to do official Koji builds, the sources need to be present in
dist-git: job <a href="#koji_build"><code>koji_build</code></a> can take care of that.</p>
<p>(The job used to be called <code>production_build</code> but we are deprecating that name in favour of
the more explicit <code>upstream_koji_build</code>.)</p>
<p>Supported triggers:</p>
<ul>
<li><strong>pull_request</strong> &ndash; check out content of the pull request</li>
<li><strong>commit</strong> &ndash; reacts to new commits to the specified branch</li>
<li><strong>release</strong> &ndash; check out content of the tag associated with the release</li>
</ul>
<p>Required parameters:</p>
<ul>
<li><strong>branch</strong> &ndash; the name of the branch we want to build for when using <strong>commit</strong> trigger.</li>
</ul>
<p>Optional parameters:</p>
<ul>
<li><strong>targets</strong> &ndash; (a list of) targets we want to build for,
list of supported targets can be listed using with <code>koji list-targets</code>.
You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</li>
</ul>
<h5 id="propose_downstream">
  propose_downstream
  <a class="anchor" href="#propose_downstream">#</a>
</h5>
<p>Land a new upstream release in Fedora. This job only makes sure the changes
happen in Fedora dist-git - no builds. A pull request is created as a result.</p>
<p>Supported triggers: <strong>release</strong>.</p>
<p>Optional parameters:</p>
<ul>
<li><strong>dist_git_branches</strong> - a (list of) branch(es) in dist-git where packit should work (defaults to <code>main</code>).
You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">propose_downstream</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">release</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">propose_downstream</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">release</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dist_git_branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">f35</span>
</span></span></code></pre></div><p>This config would update Fedora Rawhide and Fedora 35 dist-git branches.</p>
<p>If you need to do any change in the pull request, you need to locally fetch the source branch
of the Packit&rsquo;s pull request and push it (with a fix) to your fork (as it is not possible to push to the branch
created in the Packit&rsquo;s fork):</p>
<pre><code>git fetch ssh://$USER.fedoraproject.org/forks/packit/rpms/$YOUR_PACKAGE.git refs/heads/*:refs/remotes/packit/*
git cherry-pick packit/$VERSION-$BRANCH-update-propose_downstream
</code></pre>
<h5 id="pull_from_upstream">
  pull_from_upstream
  <a class="anchor" href="#pull_from_upstream">#</a>
</h5>
<p>A dist-git only job that opens a new dist-git pull request in
src.fedoraproject.org when a new upstream release happens using a notification
from <a href="https://release-monitoring.org/">release-monitoring.org</a>.</p>
<p>This job utilizes the same logic as <code>propose_downstream</code> with the only
exception that it is defined and executed in dist-git.</p>
<p>Use <a href="#issue_repository"><code>issue_repository</code></a> option to get information about
possible failures during the update process.</p>
<p>Requirements:</p>
<ul>
<li>The job is defined in a Packit config in the default branch of the dist-git
repository (<code>rawhide</code>). Packit configs on other branches are ignored.</li>
<li>Upstream release monitoring is active for the package. <a href="https://docs.fedoraproject.org/en-US/package-maintainers/Upstream_Release_Monitoring/">The monitoring
status</a>
in dist-git should be set to <code>Monitoring</code>).</li>
<li><a href="#upstream_project_url"><code>upstream_project_url</code></a> is defined in the configuration.</li>
</ul>
<blockquote class="book-hint info">
  Upstreams (defined in <code>upstream_project_url</code>) hosted in these Git forges are currently supported: <a href="https://github.com">https://github.com</a>, <a href="https://gitlab.com">https://gitlab.com</a>, <a href="https://gitlab.freedesktop.org">https://gitlab.freedesktop.org</a>,
<a href="https://gitlab.gnome.org">https://gitlab.gnome.org</a>, <a href="https://salsa.debian.org">https://salsa.debian.org</a>.
Support for working with upstreams in all Git forges is planned to be
worked on shortly (<a href="https://github.com/packit/packit-service/issues/1907">see</a>).
</blockquote>

<p>Supported triggers: <strong>release</strong>.</p>
<p>Optional parameters:</p>
<ul>
<li><strong>dist_git_branches</strong> - a (list of) branch(es) in dist-git where packit should work (defaults to <code>main</code>).
You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">upstream_project_url</span>: <span style="color:#ae81ff">https://github.com/packit/packit</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">pull_from_upstream</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">release</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dist_git_branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">fedora-all</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">epel-9</span>
</span></span></code></pre></div><p>Once a new upstream release happens, Packit will open a pull request with it in
all active Fedora releases and EPEL 9.</p>
<p>If you need to do any change in the pull request, you need to locally fetch the source branch
of the Packit&rsquo;s pull request and push it (with a fix) to your fork (as it is not possible to push to the branch
created in the Packit&rsquo;s fork):</p>
<pre><code>git fetch ssh://$USER.fedoraproject.org/forks/packit/rpms/$YOUR_PACKAGE.git refs/heads/*:refs/remotes/packit/*
git cherry-pick packit/$VERSION-$BRANCH-update-pull_from_upstream
</code></pre>
<p>For more details, check <a href="/docs/fedora-releases-guide">our release guide</a>.</p>
<h5 id="koji_build">
  koji_build
  <a class="anchor" href="#koji_build">#</a>
</h5>
<p>Trigger the build in
<a href="https://koji.fedoraproject.org/koji/">Fedora Koji</a> build system
as a reaction to a new dist-git commit.
A Packit config file needs to be in the dist-git repository
to allow this job to be triggered.
Packit loads the config from the newly pushed commit.</p>
<p>The build is triggered only for commits with a spec-file change.</p>
<p>By default, only merged pull requests created by Packit are being acted upon so the <a href="https://docs.fedoraproject.org/en-US/fesco/Provenpackager_policy/">proven packager
workflow</a> is
preserved, <a href="https://github.com/packit/packit-service/issues/1490">details
here</a>. You can override this behaviour by specifying
<code>allowed_pr_authors</code> and/or <code>allowed_committers</code> in the job configuration (see below). For direct pushes, the committer needs to
be specified in the  <code>allowed_committers</code> and for merged pull requests the author of the PR needs to be
specified in the <code>allowed_pr_authors</code> .</p>
<p>There is no UI provided by Packit for the job,
but it is visible across Fedora systems (as you can see in the following image).
The koji build behaves as it was created manually, and you can utilise
<a href="https://apps.fedoraproject.org/notifications/about">Fedora Notifications</a>
to be informed about the builds. Also, you can configure a repository where should we
open issues in case of errors during the job via <a href="/docs/configuration#issue_repository"><code>issue_repository</code></a> configuration key.</p>
<p>For retriggering the job, see <a href="/docs/fedora-releases-guide">our release guide</a>.</p>
<p>For Koji builds from upstream, see <a href="#upstream_koji_build"><code>upstream_koji_build</code></a>.</p>
<p>Supported triggers:</p>
<ul>
<li><strong>commit</strong> &ndash; reacts to new commits to the specified branch (in dist-git)</li>
</ul>
<p>Required parameters:</p>
<ul>
<li><strong>dist_git_branches</strong> &ndash; the name of the dist-git branch we want to build for when using <strong>commit</strong> trigger.
You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</li>
</ul>
<p>Optional parameters:</p>
<ul>
<li><strong>scratch</strong> &ndash; defaults to <code>false</code>, use to create scratch (test) builds
instead of the real production builds</li>
<li><strong>allowed_pr_authors</strong> - a list of FAS accounts of PR authors whose merged pull requests will trigger koji builds
(defaults to <code>['packit']</code>).</li>
<li><strong>allowed_committers</strong> - a list of FAS accounts of committers whose pushes to dist-git will trigger koji builds
(defaults to an empty list).</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">koji_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">commit</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dist_git_branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">fedora-all</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">epel-8</span>
</span></span></code></pre></div><h5 id="bodhi_update">
  bodhi_update
  <a class="anchor" href="#bodhi_update">#</a>
</h5>
<p>Create a new update in
<a href="https://bodhi.fedoraproject.org">Fedora Bodhi</a> for successful
Koji build.
A Packit config file needs to be in the dist-git repository
to allow this job to be triggered.
Packit loads the config from the commit the build is triggered from.</p>
<p>For now, the Bodhi update is created only for builds submitted by the Packit FAS user.
(See <a href="#koji_build"><code>koji_build</code></a> job for more details on how to set this up.)
This is just for the early stage of this job, and
we can easily turn off that filter.
Let us know if you need this condition to be removed.</p>
<p>There is no UI provided by Packit for the job,
but it is visible across Fedora systems
like a manually created Bodhi update, and you can utilise
<a href="https://apps.fedoraproject.org/notifications/about">Fedora Notifications</a>
to tweak the notifications settings.</p>
<p>For retriggering the job, see <a href="/docs/fedora-releases-guide">our release guide</a>.</p>
<p>Note that this job is really new and not mature yet &ndash; let us know if you find anything problematic
or any improvement we can implement.</p>
<p>Supported triggers:</p>
<ul>
<li><strong>commit</strong> &ndash; Packit uses the original action as a config trigger, so you need to use <code>commit</code> as a trigger.
The real trigger is a successful Koji build (that was triggered from a commit).</li>
</ul>
<p>Required parameters:</p>
<ul>
<li><strong>dist_git_branches</strong> &ndash; the name of the dist-git branch(es) the build we want to use is coming from.
You can also use the <a href="#aliases">aliases provided by Packit</a>
to not need to change the config file when the new system version is released.</li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">bodhi_update</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">commit</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">dist_git_branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">fedora-stable</span> <span style="color:#75715e"># rawhide updates are created automatically</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">epel-8</span>
</span></span></code></pre></div><h5 id="vm_image_build">
  vm_image_build
  <a class="anchor" href="#vm_image_build">#</a>
</h5>
<p>Supported triggers:</p>
<ul>
<li><strong>pull_request</strong></li>
</ul>
<p>Image Parameters (Packit does not sanitize these and just passes them to Image Builder;
check <a href="https://console.redhat.com/docs/api/image-builder">Image Builder&rsquo;s API
documentation</a> for details).</p>
<ul>
<li><strong>image_request</strong> &ndash; values passed to <a href="https://console.redhat.com/docs/api/image-builder/v1#operations-default-ComposeImage">the &ldquo;image_requests&rdquo; field</a> of Image Builder&rsquo;s API</li>
<li><strong>image_customizations</strong> &ndash; values passed to <a href="https://console.redhat.com/docs/api/image-builder/v1#operations-default-ComposeImage">the &ldquo;customizations&rdquo; field</a> of Image Builder&rsquo;s API</li>
<li><strong>image_distribution</strong> &ndash; name of the &ldquo;base image&rdquo; (examples: rhel-90, fedora-36)</li>
</ul>
<p>Required parameters:</p>
<ul>
<li><strong>copr_chroot</strong> &ndash; name of the chroot to use for installing packages in the image</li>
<li><strong>owner</strong> &ndash; Copr project owner</li>
<li><strong>project</strong> &ndash; Copr project name</li>
</ul>
<p>Image builds are only triggered after a collaborator places a comment <code>/packit vm-image-build</code> in a pull request. The image builds are <strong>NOT</strong> submitted
automatically. This is a subject to change as we improve the integration in future.</p>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">job</span>: <span style="color:#ae81ff">vm_image_build</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">trigger</span>: <span style="color:#ae81ff">pull_request</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">image_request</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">architecture</span>: <span style="color:#ae81ff">x86_64</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image_type</span>: <span style="color:#ae81ff">aws</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">upload_request</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">aws</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">options</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">share_with_accounts</span>: [<span style="color:#e6db74">&#34;123456789&#34;</span>]
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">image_customizations</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">packages</span>: [<span style="color:#ae81ff">foo-bar]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">image_distribution</span>: <span style="color:#ae81ff">fedora-36</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">john-foo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">project</span>: <span style="color:#ae81ff">foo-bar-martini</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">copr_chroot</span>: <span style="color:#ae81ff">fedora-36-x86_64</span>
</span></span></code></pre></div><h2 id="user-configuration-file">
  User configuration file
  <a class="anchor" href="#user-configuration-file">#</a>
</h2>
<p>When running packit as a tool locally, it is convenient to use a configuration
file to provide data such as API tokens. Packit respects <code>XDG_CONFIG_HOME</code>
environment variable. If not set, it looks inside <code>~/.config/</code> directory.</p>
<p>The acceptable names are the same as for the package config:</p>
<ul>
<li><code>.packit.yaml</code></li>
<li><code>.packit.yml</code></li>
<li><code>.packit.json</code></li>
<li><code>packit.yaml</code></li>
<li><code>packit.yml</code></li>
<li><code>packit.json</code></li>
</ul>
<h3 id="values">
  Values
  <a class="anchor" href="#values">#</a>
</h3>
<table>
<thead>
<tr>
<th>Key name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>debug</code></td>
<td>bool</td>
<td>enable debug logs</td>
</tr>
<tr>
<td><code>fas_user</code></td>
<td>string</td>
<td>username in Fedora account system; this is utilized when authenticating with Bodhi using Kerberos</td>
</tr>
<tr>
<td><code>kerberos_realm</code></td>
<td>string</td>
<td>Kerberos realm to use for authentication, example &ldquo;FEDORAPROJECT.ORG&rdquo;</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td>dict</td>
<td>tokens for services (GitHub, Pagure)</td>
</tr>
<tr>
<td><code>upstream_git_remote</code></td>
<td>string</td>
<td>name of the git remote to discover upstream project URL from</td>
</tr>
<tr>
<td><code>redhat_api_refresh_token</code></td>
<td>string</td>
<td>Red Hat API token, can be obtained <a href="https://access.redhat.com/management/api">here</a></td>
</tr>
</tbody>
</table>
<p>The <code>authentication</code> is a dictionary where:</p>
<ul>
<li>key is a hostname, url or name that can be mapped to a service-type, for example <code>github.com</code> or <code>pagure</code></li>
<li>value is a dictionary with keys: <code>token</code> and <code>instance_url</code> (optional)</li>
</ul>
<p>e.g.:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">authentication</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">github.com</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">token</span>: <span style="color:#ae81ff">mnbvcxz123456</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">pagure</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">token</span>: <span style="color:#ae81ff">qwertyuiop098765</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">instance_url</span>: <span style="color:#ae81ff">https://src.fedoraproject.org</span>
</span></span></code></pre></div><p>The GitHub token is needed when packit interacts with GitHub API,
get it at <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a> (getting full read &amp; write repo scope should be enough).
The Pagure token needed to access REST API,
get it at <a href="https://src.fedoraproject.org/settings#nav-api-tab">https://src.fedoraproject.org/settings#nav-api-tab</a></p>
<p>Specifying tokens as direct keys <code>github_token</code> and <code>pagure_user_token</code>
has been deprecated and will be removed in future versions.</p>
<p>Since API tokens are a very sensitive information, please do NOT ever store
them in a public (such as a GitHub repository). The configuration file here is
located on your workstation, please do NOT confuse it with a config file for
your project - that one is described above in the first section of this
document.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#top-level-keys">Top level keys</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#packit-as-a-service">Packit-as-a-Service</a>
      <ul>
        <li><a href="#packit-service-jobs">Packit service jobs</a></li>
      </ul>
    </li>
    <li><a href="#user-configuration-file">User configuration file</a>
      <ul>
        <li><a href="#values">Values</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












